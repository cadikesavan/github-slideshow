<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="ec8deddb-3cf8-4f53-b757-5dccd861782b" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Delete" searchProperties="true" timeout="40000" disabled="true" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="ec8deddb-3cf8-4f53-b757-5dccd861782bfileName">Delete</con:setting></con:settings><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="groovy" name="Groovy Script 2" id="9be7eb89-e46c-44f8-995a-9a2966a5d8ac" disabled="true"><con:settings/><con:config><script>// Create the XmlHolder object for the response of the Request 1 request
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def holder = groovyUtils.getXmlHolder( "GetBinderRequests#Response" )

        if (holder) {
   def isRetry = true
   while(isRetry) {
        def state = holder.getNodeValue("//data")
        log.info "value of state in the response is ${state}"
        if (state != 'BinderRequest is currently being Processe') {
            log.info "Since the value is success, setting value of isRetry to false"
            isRetry = false
        } else {
           log.info "Retring as state is not success"
           testRunner.runTestStepByName("GetBinderRequests")
        }</script></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script 3" id="322c52e3-715e-48d6-a42f-2e344accd8da" disabled="true"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )

// get XmlHolder for response message
 def holder = groovyUtils.getXmlHolder("GetBinderRequests#Response") 
 // get password using XPath 
 def value = holder.getNodeValue("//data")

 log.info(value)

 def isRetry = true

while(isRetry) {
        def state = holder.getNodeValue('//data')
        log.info "value of state in the response is ${state}"
        if (state == 'BinderRequest is currently being Processed') {
            log.info "Since the value is success, setting value of isRetry to false"
            isRetry = false
        } else {
           log.info "Retring as state is not success"
           testRunner.runTestStepByName('GetBinderRequests')
        }</script></con:config></con:testStep><con:testStep type="datasink" name="csv sink" id="726319ed-eff6-4578-9b17-9dfcddd9023e" disabled="true"><con:settings/><con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSink type="File"><con:configuration><fileName>C:/CHITRA/Source/Repos/Test/TestData/Payment.csv</fileName><separator>,</separator><escape>"</escape><quote>true</quote><trim>true</trim><append>false</append><encoding>Cp1252</encoding></con:configuration></con:dataSink><con:properties><con:property><con:name>URL</con:name><con:value>${GetBinderRequests#Response#$['paymentUrl']}</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="de9ba37c-42ba-4664-90e0-f7a7fa59d53c" disabled="true"><con:settings/><con:config><script>import org.apache.poi.ss.usermodel.Cell 
import org.apache.poi.ss.usermodel.Row 
import org.apache.poi.xssf.usermodel.XSSFSheet 
import org.apache.poi.xssf.usermodel.XSSFWorkbook 

import java.io.FileOutputStream 
import java.io.IOException 
import java.util.List 

XSSFWorkbook workbook = new XSSFWorkbook() 
XSSFSheet sheet = workbook.createSheet("Payment") 

int rowNum = 0 
int colNum = 0 

headers = ["URLRetrieved"] 

Row row = sheet.createRow(rowNum) 
for(String header : headers) {
  Cell cell = row.createCell(colNum++) 
  cell.setCellValue(header) 
}

rowNum = 1
colNum = 0

row = sheet.createRow(rowNum++) 
Cell cell = row.createCell(colNum++) 

def response = context.expand( '${GetBinderRequests#Response#$[\'paymentUrl\']}' )


cell.setCellValue( response)

cell = row.createCell(colNum++) 
cell.setCellValue("Second Value") 
cell = row.createCell(colNum++) 
cell.setCellValue("Third Value") 

try {
    FileOutputStream outputStream = new FileOutputStream("C:\\CHITRA\\Source\\Repos\\Test\\TestData\\PaymentURL.xlsx") 
    workbook.write(outputStream) 
    workbook.close() 
} catch (IOException e) {
    e.printStackTrace() 
}</script></con:config></con:testStep><con:testStep type="groovy" name="ExtractPaymentURL" id="7fa79e84-b8a5-4f2e-af4f-225e10bbd6fc" disabled="true"><con:settings/><con:config><script>def string = context.expand( '${GetBinderRequests#Response#$[\'paymentUrl\']}' )


def sub = string.substring(29,64)

return sub</script></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script 4" id="fedd3744-f884-4b52-bf38-9b53db4439fa" disabled="true"><con:settings/><con:config><script>


BinderRequest is currently being Processed</script></con:config></con:testStep><con:testStep type="transfer" name="PropertyTransfer 1" id="b4fbfb82-1854-4c72-8388-f2b6d0944073" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" entitize="false" ignoreEmpty="false" transferToAll="false" transferChildNodes="false"><con:name>data</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>GetBinderRequests</con:sourceStep><con:sourcePath>//data[1]</con:sourcePath><con:targetType xsi:nil="true"/><con:targetStep>BinderId</con:targetStep><con:targetPath/><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="BinderId" id="09f51219-f341-4f1e-bc13-6b3c34dc58db" disabled="true"><con:settings/><con:config service="Pup Binders API" resourcePath="/binders" methodName="POST" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="BinderId" id="ed7964a4-d166-4af3-92a5-01009547d902" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://dev.api.rlicorp.io/pup/v1.0</con:endpoint><con:request>{
  "binderRequestId": "${BinderRequests#Response#$['binderRequestId']}"
}</con:request><con:originalUri>https://dev.api.rlicorp.io/pup/v1.0/binders</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="40ba1ba3-0412-4507-9e20-b54d7ba966b5" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>201</codes></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><con:entry key="X-RLI-Producer" value="00995"/></con:parameters><con:environmentSpec><con:entry environmentId="75114eaf-e15a-4a2d-962b-2c43697c3a81"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Dev</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="tcintegrationteststep" name="TestComplete" id="37c1713f-9814-40b6-aadd-6c6a7a9cf70b" disabled="true"><con:settings/><con:config><timeout>90000</timeout><executionResult>2</executionResult><resultDescription>The last test results include error messages.</resultDescription><testRunner>TestComplete 14</testRunner><runMode>TEST</runMode><exportTestLog>C:\CHITRA\Source\Repos\Test\TestData\TestLog\Log.txt</exportTestLog><silentModeLog>C:\CHITRA\Source\Repos\Test\TestData\TestLog\SilentModeLog.txt</silentModeLog><projectSuiteFile>C:\CHITRA\Source\Repos\TestComplete\Connect\Connect.pjs</projectSuiteFile><projectName>PUP</projectName><scriptUnit>LaunchBrowser</scriptUnit><scriptRoutine>LaunchBrowser</scriptRoutine><silentMode>true</silentMode><showTestLog>true</showTestLog><warningAsError>false</warningAsError><test>PaymentURL</test><otherTest/><otherArgs/></con:config></con:testStep><con:testStep type="restrequest" name="GetBinderId" id="4b48586a-db36-49f2-bf4e-e239be136555" disabled="true"><con:settings/><con:config service="Pup Binders API" resourcePath="/binders/{binderId}" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetBinderId" id="2804bdee-9191-4076-8a56-8491a7957f24" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://dev.api.rlicorp.io/pup/v1.0</con:endpoint><con:request/><con:originalUri>https://dev.api.rlicorp.io/pup/v1.0/binders/ac6c0951-872a-43a3-9b10-bd38635907eb</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="2e50331d-49a4-4674-b056-65074daf3c74" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="7ba80a51-145b-4f5f-94eb-2ea42dd651e5" name="Check for existence of [policyNumber]"><con:configuration><path>$['policyNumber']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><con:entry key="binderId" value="${#[Workflow#Full Quote Option#BinderRequests]#Response#$['binderRequestId']}"/><con:entry key="X-RLI-Producer" value="00995"/></con:parameters><con:environmentSpec><con:entry environmentId="75114eaf-e15a-4a2d-962b-2c43697c3a81"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Dev</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="GetDBinderocument" id="797203e6-7a7d-4114-8adc-cca672283dfd" disabled="true"><con:settings/><con:config service="Pup Documents API" resourcePath="/documents/{documentId}" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDBinderocument" id="86b781c1-67c2-4e57-b1da-52346cd1f040" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://dev.api.rlicorp.io/pup/v1.0</con:endpoint><con:request/><con:originalUri>https://dev.api.rlicorp.io/pup/v1.0/documents/ea954bb1-e425-417e-ba97-41a1cba69072</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="4c08ac47-8853-4f2a-bfc1-33a0e3771a03" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><con:entry key="X-RLI-Producer" value="00995"/><con:entry key="documentId" value="${GetPolicyDetails#Response#$['documents'][1]['documentId']}"/></con:parameters><con:environmentSpec><con:entry environmentId="75114eaf-e15a-4a2d-962b-2c43697c3a81"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Dev</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="GetApplicationDocument" id="5d8fc466-9955-422d-b0f6-ced1a9e7d1f1" disabled="true"><con:settings/><con:config service="Pup Documents API" resourcePath="/documents/{documentId}" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetApplicationDocument" id="86b781c1-67c2-4e57-b1da-52346cd1f040" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://dev.api.rlicorp.io/pup/v1.0</con:endpoint><con:request/><con:originalUri>https://dev.api.rlicorp.io/pup/v1.0/documents/ea954bb1-e425-417e-ba97-41a1cba69072</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="4c08ac47-8853-4f2a-bfc1-33a0e3771a03" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><con:entry key="X-RLI-Producer" value="00995"/><con:entry key="documentId" value="${GetPolicyDetails#Response#$['documents'][0]['documentId']}"/></con:parameters><con:environmentSpec><con:entry environmentId="75114eaf-e15a-4a2d-962b-2c43697c3a81"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Dev</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="GetPolicyDetails" id="d252f10f-0f0c-4e02-adb6-b26a183bf9af" disabled="true"><con:settings/><con:config service="Pup Policies API" resourcePath="/policies/{policyNumber}" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetPolicyDetails" id="11769595-62fe-498c-9b88-904eb6213f43" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://dev.api.rlicorp.io/pup/v1.0</con:endpoint><con:request/><con:originalUri>https://api.rlicorp.io/pup/v1.0/policies/PUP0000025</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="3e77c0df-45d8-4bd3-a943-b4addad7374c" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="814e3548-9891-4096-9c38-007fab623d60" name="Check for existence of [premium]"><con:configuration><path>$['premium']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="2af37f19-75f9-4b93-91d2-f7bc7c5ef5f3" name="Check for existence of [name]"><con:configuration><path>$['documents'][1]['name']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="5c77fc2f-ea79-42d0-87df-3ea1c9bc4423" name="Check for existence of [name]"><con:configuration><path>$['documents'][0]['name']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><con:entry key="X-RLI-Producer" value="00995"/><con:entry key="policyNumber" value="${GetBinderId#Response}"/></con:parameters><con:environmentSpec><con:entry environmentId="75114eaf-e15a-4a2d-962b-2c43697c3a81"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Dev</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:properties/><con:reportParameters/><con:environmentSpec><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:testCase>