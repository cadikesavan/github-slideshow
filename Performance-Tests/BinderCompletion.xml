<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="9c5608d1-afde-4de1-87c9-3ab837cec891" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="BinderCompletion" searchProperties="true" timeout="40000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" zephyrTestName="" zephyrTestId="" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="9c5608d1-afde-4de1-87c9-3ab837cec891fileName">BinderCompletion</con:setting></con:settings><con:testStep type="restrequest" name="GetBinderId" id="c6a29d03-1779-4113-b5a7-3e9db7c7e065"><con:settings/><con:config service="Pup Binders API" resourcePath="/binders/{binderId}" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetBinderId" id="2804bdee-9191-4076-8a56-8491a7957f24" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://dev.api.rlicorp.io/pup/v1.0</con:endpoint><con:request/><con:originalUri>https://dev.api.rlicorp.io/pup/v1.0/binders/ac6c0951-872a-43a3-9b10-bd38635907eb</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="2e50331d-49a4-4674-b056-65074daf3c74" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="7ba80a51-145b-4f5f-94eb-2ea42dd651e5" name="Check for existence of [policyNumber]"><con:configuration><path>$['policyNumber']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Dev</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><con:entry key="binderId" value="${#[Performance Tests#BinderRequests#BinderRequests]#Response#$['binderRequestId']}"/><con:entry key="X-RLI-Producer" value="00995"/></con:parameters><con:environmentSpec><con:entry environmentId="75114eaf-e15a-4a2d-962b-2c43697c3a81"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Dev</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="GetBinderIdStatusCheck" id="754a3b66-40df-4ec3-9f56-84552a7bc90a"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )


	def isRetry =  true

	testRunner.runTestStepByName("GetBinderId")
	

	while(isRetry == true )

	{

		def httpResponseHeaders = context.testCase.testSteps["GetBinderId"].testRequest.response.responseHeaders
		def httpStatus = httpResponseHeaders["#status#"]
		def httpStatusCode = (httpStatus =~ "[1-5]\\d\\d")[0]
		
		//log.info("Http Staus code is: " + httpStatusCode)

			if(httpStatusCode == "200")
			{
			//log.info("Http status code is :" + httpStatusCode  + "setting the isRetry to false")
			
			isRetry = false

			//break
			
			}

			else if (httpStatusCode == "202")

			{
			//log.info("Retrying as Http Status code is: " + httpStatusCode)

			testRunner.runTestStepByName("GetBinderId")			

			
			}
			
			else if (httpStatusCode == "400")

			{
			//log.info(" Http Status code is returned , please check the validation errors: " + httpStatusCode)

			isRetry = false
			//break
			
			}
			

			else
			{
				
				throw new Exception("Result not as expected!")
				isRetry = false
				
			}
			
		
 }
	</script></con:config></con:testStep><con:testStep type="restrequest" name="GetPolicyDetails" id="df5b6301-d2ec-49ba-b40d-c01207d8fd6c"><con:settings/><con:config service="Pup Policies API" resourcePath="/policies/{policyNumber}" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetPolicyDetails" id="11769595-62fe-498c-9b88-904eb6213f43" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://dev.api.rlicorp.io/pup/v1.0</con:endpoint><con:request/><con:originalUri>https://api.rlicorp.io/pup/v1.0/policies/PUP0000025</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="3e77c0df-45d8-4bd3-a943-b4addad7374c" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="814e3548-9891-4096-9c38-007fab623d60" name="Check for existence of [premium]" disabled="true"><con:configuration><path>$['premium']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="2af37f19-75f9-4b93-91d2-f7bc7c5ef5f3" name="Check for existence of [name]" disabled="true"><con:configuration><path>$['documents'][1]['name']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="5c77fc2f-ea79-42d0-87df-3ea1c9bc4423" name="Check for existence of [name]" disabled="true"><con:configuration><path>$['documents'][0]['name']</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><con:entry key="X-RLI-Producer" value="00995"/><con:entry key="policyNumber" value="${GetBinderId#Response#$['policyNumber']}"/></con:parameters><con:environmentSpec><con:entry environmentId="75114eaf-e15a-4a2d-962b-2c43697c3a81"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Dev</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Dev</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>df5b6301-d2ec-49ba-b40d-c01207d8fd6c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>754a3b66-40df-4ec3-9f56-84552a7bc90a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:environmentSpec><con:entry environmentId="a1acc9d9-dedb-4536-958a-a5cafc7c0d55"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="8c4dd766-676d-4232-a816-b1b61c59538d"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:testCase>